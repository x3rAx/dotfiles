#!/bin/sh

SCRIPT="$(realpath "$0")"
SCRIPT_DIR="$(dirname "$SCRIPT")"

XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-${HOME}/.config}"
BSPWM_DIR="${XDG_CONFIG_HOME}/bspwm"
RUN_DIR="${BSPWM_DIR}/run"
mkdir -p "$RUND_DIR"

path_prepend() { [ -e $1 ] && PATH=":${PATH}" && PATH="${1}${PATH//:$1/}"; }

path_prepend "${HOME}/.local/bin"
export PATH

# --- Autostart ---

$HOME/.config/polybar/launch.sh &
( sleep 1 && "${BSPWM_DIR}/autostart.sh"; ) &

#sxhkd_pidfile="${RUN_DIR}/sxhkd.pid"
#[[ -f $sxhkd_pidfile ]] && kill "$(< "$sxhkd_pidfile")" 2>/dev/null
#sxhkd -c "${XDG_CONFIG_HOME}/sxhkd/bspwm.sxhkdrc" & echo "$!" >"$sxhkd_pidfile"

pkill sxhkd; sxhkd & # sxhkd is started by nix package of bspwm but with wrong PATH
pkill picom; picom --experimental-backends & # Experimental for blur with "dual_kawase"
feh --bg-fill ~/Pictures/\[Wallpapers\]/1920x1080/tree-on-a-hill.jpg &

# --- Setup ---

# Workspaces
bspc monitor -d {1..10}

# Config
bspc config window_gap              20
bspc config border_width            1
bspc config pointer_follows_monitor false
bspc config focus_follows_pointer   true
bspc config focused_border_color    "#0071db"
bspc config removal_adjustment      "false"

